"use strict";(self.webpackChunkeprescription_angular=self.webpackChunkeprescription_angular||[]).push([[915],{915:($,m,c)=>{c.r(m),c.d(m,{FarmaciasInventarioComponent:()=>D});var e=c(4438),g=c(177),l=c(4341),r=c(8516),_=c(5701),h=c(1797),u=c(2193),v=c(8961),f=c(8359),p=c(3217),b=c(3036),F=c(1822);function x(o,s){1&o&&(e.j41(0,"div",9),e.nrm(1,"div",10),e.j41(2,"span",11),e.EFF(3,"Cargando farmacias..."),e.k0s()())}function y(o,s){if(1&o&&(e.j41(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15)(4,"div",16)(5,"p",17),e.EFF(6,"Total farmacias"),e.k0s(),e.j41(7,"p",18),e.EFF(8),e.k0s()(),e.j41(9,"div",19),e.nrm(10,"lucide-icon",20),e.k0s()()()(),e.j41(11,"div",21)(12,"div",14)(13,"div",15)(14,"div",16)(15,"p",17),e.EFF(16,"Activas"),e.k0s(),e.j41(17,"p",22),e.EFF(18),e.k0s()(),e.j41(19,"div",23),e.nrm(20,"lucide-icon",24),e.k0s()()()(),e.j41(21,"div",25)(22,"div",14)(23,"div",15)(24,"div",16)(25,"p",17),e.EFF(26,"Inactivas"),e.k0s(),e.j41(27,"p",22),e.EFF(28),e.k0s()(),e.j41(29,"div",26),e.nrm(30,"lucide-icon",27),e.k0s()()()(),e.j41(31,"div",28)(32,"div",14)(33,"div",15)(34,"div",16)(35,"p",17),e.EFF(36,"Suspendidas"),e.k0s(),e.j41(37,"p",22),e.EFF(38),e.k0s()(),e.j41(39,"div",29),e.nrm(40,"lucide-icon",30),e.k0s()()()(),e.j41(41,"div",31)(42,"div",14)(43,"div",15)(44,"div",16)(45,"p",17),e.EFF(46,"Provincias"),e.k0s(),e.j41(47,"p",22),e.EFF(48),e.k0s()(),e.j41(49,"div",32),e.nrm(50,"lucide-icon",33),e.k0s()()()()()),2&o){const t=e.XpG();e.R7$(),e.BMQ("aria-label","Total de farmacias: "+t.getTotalPharmacies()),e.R7$(7),e.JRh(t.getTotalPharmacies()),e.R7$(2),e.Y8G("img",t.building2Icon),e.R7$(8),e.JRh(t.getActivePharmacies()),e.R7$(2),e.Y8G("img",t.checkCircleIcon),e.R7$(8),e.JRh(t.getInactivePharmacies()),e.R7$(2),e.Y8G("img",t.xCircleIcon),e.R7$(8),e.JRh(t.getSuspendedPharmacies()),e.R7$(2),e.Y8G("img",t.alertCircleIcon),e.R7$(8),e.JRh(t.getProvinceCount()),e.R7$(2),e.Y8G("img",t.mapPinIcon)}}function P(o,s){if(1&o&&(e.j41(0,"option",57),e.EFF(1),e.k0s()),2&o){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.nombre," ")}}function I(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",58),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.clearFilters())}),e.nrm(1,"lucide-icon",55),e.EFF(2," Limpiar "),e.k0s()}if(2&o){const t=e.XpG(2);e.R7$(),e.Y8G("img",t.filterIcon)}}function C(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",34)(1,"div",35)(2,"div",36),e.nrm(3,"lucide-icon",37),e.j41(4,"h3",38),e.EFF(5,"Listado de Farmacias"),e.k0s(),e.j41(6,"span",39),e.EFF(7),e.k0s()(),e.j41(8,"button",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.openNewPharmacyModal())}),e.nrm(9,"lucide-icon",41),e.EFF(10," Nueva Farmacia "),e.k0s()(),e.j41(11,"div",42)(12,"div",43)(13,"div",44),e.nrm(14,"lucide-icon",45),e.j41(15,"input",46),e.mxI("ngModelChange",function(i){e.eBV(t);const n=e.XpG();return e.DH7(n.searchTerm,i)||(n.searchTerm=i),e.Njj(i)}),e.bIt("ngModelChange",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSearchChange())}),e.k0s()()(),e.j41(16,"select",47),e.mxI("ngModelChange",function(i){e.eBV(t);const n=e.XpG();return e.DH7(n.selectedProvince,i)||(n.selectedProvince=i),e.Njj(i)}),e.bIt("ngModelChange",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onProvinceChange())}),e.j41(17,"option",48),e.EFF(18,"Todas las provincias"),e.k0s(),e.DNE(19,P,2,2,"option",49),e.k0s(),e.j41(20,"select",50),e.mxI("ngModelChange",function(i){e.eBV(t);const n=e.XpG();return e.DH7(n.selectedStatus,i)||(n.selectedStatus=i),e.Njj(i)}),e.bIt("ngModelChange",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onStatusChange())}),e.j41(21,"option",48),e.EFF(22,"Todos los estados"),e.k0s(),e.j41(23,"option",51),e.EFF(24,"Activas"),e.k0s(),e.j41(25,"option",52),e.EFF(26,"Inactivas"),e.k0s(),e.j41(27,"option",53),e.EFF(28,"Suspendidas"),e.k0s()(),e.j41(29,"button",54),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.exportPharmacies())}),e.nrm(30,"lucide-icon",55),e.EFF(31," Exportar "),e.k0s(),e.DNE(32,I,3,1,"button",56),e.k0s()()}if(2&o){const t=e.XpG();e.R7$(3),e.Y8G("img",t.building2Icon),e.R7$(4),e.E5c(" (",t.filteredPharmacies.length," farmacia",1!==t.filteredPharmacies.length?"s":""," encontrada",1!==t.filteredPharmacies.length?"s":"",") "),e.R7$(2),e.Y8G("img",t.plusIcon),e.R7$(5),e.Y8G("img",t.searchIcon),e.R7$(),e.R50("ngModel",t.searchTerm),e.R7$(),e.R50("ngModel",t.selectedProvince),e.R7$(3),e.Y8G("ngForOf",t.provincias),e.R7$(),e.R50("ngModel",t.selectedStatus),e.R7$(10),e.Y8G("img",t.downloadIcon),e.R7$(2),e.Y8G("ngIf",t.hasActiveFilters())}}function R(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",71),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.clearFilters())}),e.EFF(1," Limpiar filtros "),e.k0s()}}function E(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",63)(1,"div",64),e.nrm(2,"lucide-icon",65),e.j41(3,"h3",66),e.EFF(4),e.k0s(),e.j41(5,"p",67),e.EFF(6),e.k0s(),e.j41(7,"div",68)(8,"button",69),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.openNewPharmacyModal())}),e.EFF(9," Registrar primera farmacia "),e.k0s(),e.DNE(10,R,2,0,"button",70),e.k0s()()()}if(2&o){const t=e.XpG(2);e.R7$(2),e.Y8G("img",t.building2Icon),e.R7$(2),e.SpI(" ",t.hasActiveFilters()?"No se encontraron farmacias":"No hay farmacias registradas"," "),e.R7$(2),e.SpI(" ",t.hasActiveFilters()?"Intenta ajustar los filtros de b\xfasqueda":"No hay farmacias registradas en el sistema"," "),e.R7$(4),e.Y8G("ngIf",t.hasActiveFilters())}}function k(o,s){1&o&&(e.j41(0,"div",98)(1,"span",99),e.EFF(2," Reciente "),e.k0s()())}function M(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",100),e.bIt("click",function(i){return e.eBV(t),e.Njj(i.stopPropagation())}),e.j41(1,"div",101)(2,"div",102),e.EFF(3," Acciones "),e.k0s(),e.j41(4,"button",103),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,n=e.XpG(3);return n.viewPharmacyDetails(i),e.Njj(n.cerrarModalAcciones())}),e.nrm(5,"lucide-icon",104),e.EFF(6," Ver detalles "),e.k0s(),e.j41(7,"button",103),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,n=e.XpG(3);return n.printPharmacy(i),e.Njj(n.cerrarModalAcciones())}),e.nrm(8,"lucide-icon",104),e.EFF(9," Imprimir informaci\xf3n "),e.k0s(),e.j41(10,"button",103),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,n=e.XpG(3);return n.editPharmacy(i),e.Njj(n.cerrarModalAcciones())}),e.nrm(11,"lucide-icon",104),e.EFF(12," Editar farmacia "),e.k0s(),e.j41(13,"div",105)(14,"button",106),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,n=e.XpG(3);return n.deletePharmacy(i),e.Njj(n.cerrarModalAcciones())}),e.nrm(15,"lucide-icon",107),e.EFF(16," Eliminar farmacia "),e.k0s()()()()}if(2&o){const t=e.XpG(4);e.R7$(5),e.Y8G("img",t.eyeIcon),e.R7$(3),e.Y8G("img",t.printerIcon),e.R7$(3),e.Y8G("img",t.editIcon),e.R7$(4),e.Y8G("img",t.trash2Icon)}}function j(o,s){if(1&o){const t=e.RV6();e.j41(0,"tr",79),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(3);return e.Njj(n.viewPharmacyDetails(i))})("keydown.enter",function(){const i=e.eBV(t).$implicit,n=e.XpG(3);return e.Njj(n.viewPharmacyDetails(i))})("keydown.space",function(i){const n=e.eBV(t).$implicit;return e.XpG(3).viewPharmacyDetails(n),e.Njj(i.preventDefault())}),e.j41(1,"td",80)(2,"div",81)(3,"div",82),e.nrm(4,"lucide-icon",83),e.k0s(),e.j41(5,"div")(6,"div",84),e.EFF(7),e.k0s(),e.DNE(8,k,3,0,"div",85),e.k0s()()(),e.j41(9,"td",80)(10,"div",86),e.EFF(11),e.k0s()(),e.j41(12,"td",87)(13,"div",88),e.nrm(14,"lucide-icon",89),e.j41(15,"span",90),e.EFF(16),e.k0s()()(),e.j41(17,"td",87)(18,"div",91),e.EFF(19),e.k0s()(),e.j41(20,"td",80)(21,"div",88),e.nrm(22,"lucide-icon",89),e.j41(23,"span",90),e.EFF(24),e.k0s()()(),e.j41(25,"td",80)(26,"span",92),e.EFF(27),e.k0s(),e.j41(28,"div",93),e.EFF(29),e.k0s()(),e.j41(30,"td",94)(31,"div",44)(32,"button",95),e.bIt("click",function(i){const n=e.eBV(t).$implicit;return e.XpG(3).toggleAccionesModal(n.id),e.Njj(i.stopPropagation())}),e.nrm(33,"lucide-icon",96),e.k0s(),e.DNE(34,M,17,4,"div",97),e.k0s()()()}if(2&o){const t=s.$implicit,a=e.XpG(3);e.BMQ("aria-label","Farmacia "+t.nombre+" c\xf3digo "+t.codigo),e.R7$(4),e.Y8G("img",a.building2Icon),e.R7$(3),e.JRh(t.codigo),e.R7$(),e.Y8G("ngIf",a.isRecentPharmacy(t.fechaRegistro)),e.R7$(3),e.JRh(t.nombre),e.R7$(3),e.Y8G("img",a.mapPinIcon),e.R7$(2),e.JRh(a.getFullLocationForPharmacy(t)),e.R7$(3),e.SpI(" ",t.direccionEspecifica," "),e.R7$(3),e.Y8G("img",a.phoneIcon),e.R7$(2),e.JRh(t.telefono),e.R7$(2),e.Y8G("ngClass",a.getStatusBadgeClass(t.estado)),e.BMQ("aria-label",a.getStatusDescription(t.estado)),e.R7$(),e.SpI(" ",a.getStatusLabel(t.estado)," "),e.R7$(2),e.SpI(" Registrada: ",a.formatDate(t.fechaRegistro)," "),e.R7$(4),e.Y8G("img",a.moreVerticalIcon),e.R7$(),e.Y8G("ngIf",a.modalAccionesAbierto===t.id)}}function w(o,s){if(1&o&&(e.j41(0,"div",72)(1,"table",73)(2,"thead",74)(3,"tr",75)(4,"th",76),e.EFF(5,"C\xf3digo"),e.k0s(),e.j41(6,"th",76),e.EFF(7,"Nombre"),e.k0s(),e.j41(8,"th",76),e.EFF(9,"Ubicaci\xf3n"),e.k0s(),e.j41(10,"th",76),e.EFF(11,"Direcci\xf3n Espec\xedfica"),e.k0s(),e.j41(12,"th",76),e.EFF(13,"Tel\xe9fono"),e.k0s(),e.j41(14,"th",76),e.EFF(15,"Estado"),e.k0s(),e.j41(16,"th",76),e.EFF(17,"Acciones"),e.k0s()()(),e.j41(18,"tbody",77),e.DNE(19,j,35,16,"tr",78),e.k0s()()()),2&o){const t=e.XpG(2);e.R7$(19),e.Y8G("ngForOf",t.paginatedPharmacies)("ngForTrackBy",t.trackByPharmacyId)}}function T(o,s){if(1&o){const t=e.RV6();e.j41(0,"button",123),e.bIt("click",function(){const i=e.eBV(t).$implicit,n=e.XpG(3);return e.Njj(n.goToPage(i))}),e.EFF(1),e.k0s()}if(2&o){const t=s.$implicit,a=e.XpG(3);e.Y8G("ngClass",t===a.currentPage?"active":"border border-gray-300 text-gray-700"),e.R7$(),e.SpI(" ",t," ")}}function G(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",108)(1,"div",109)(2,"div",110),e.EFF(3," Mostrando "),e.j41(4,"span",111),e.EFF(5),e.k0s(),e.EFF(6," a "),e.j41(7,"span",111),e.EFF(8),e.k0s(),e.EFF(9," de "),e.j41(10,"span",111),e.EFF(11),e.k0s(),e.EFF(12," resultados "),e.k0s(),e.j41(13,"div",112)(14,"div",113)(15,"span"),e.EFF(16,"Mostrar:"),e.k0s(),e.j41(17,"select",114),e.bIt("change",function(i){e.eBV(t);const n=e.XpG(2);return e.Njj(n.onItemsPerPageChange(i))}),e.j41(18,"option",115),e.EFF(19,"5"),e.k0s(),e.j41(20,"option",116),e.EFF(21,"10"),e.k0s(),e.j41(22,"option",117),e.EFF(23,"20"),e.k0s(),e.j41(24,"option",118),e.EFF(25,"50"),e.k0s()()(),e.j41(26,"div",119)(27,"button",120),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.previousPage())}),e.nrm(28,"lucide-icon",55),e.k0s(),e.DNE(29,T,2,2,"button",121),e.j41(30,"button",122),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.nextPage())}),e.nrm(31,"lucide-icon",55),e.k0s()()()()()}if(2&o){const t=e.XpG(2);e.R7$(5),e.JRh(t.getStartIndex()),e.R7$(3),e.JRh(t.getEndIndex()),e.R7$(3),e.JRh(t.filteredPharmacies.length),e.R7$(6),e.Y8G("value",t.itemsPerPage),e.R7$(10),e.Y8G("disabled",!t.hasPreviousPage()),e.R7$(),e.Y8G("img",t.chevronLeftIcon),e.R7$(),e.Y8G("ngForOf",t.getVisiblePages()),e.R7$(),e.Y8G("disabled",!t.hasNextPage()),e.R7$(),e.Y8G("img",t.chevronRightIcon)}}function O(o,s){if(1&o&&(e.j41(0,"div",59),e.DNE(1,E,11,4,"div",60)(2,w,20,2,"div",61)(3,G,32,9,"div",62),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.Y8G("ngIf",0===t.filteredPharmacies.length),e.R7$(),e.Y8G("ngIf",t.filteredPharmacies.length>0),e.R7$(),e.Y8G("ngIf",t.filteredPharmacies.length>0)}}let D=(()=>{class o{constructor(t,a){this.pharmacyService=t,this.roleDemoService=a,this.building2Icon=r.t6i,this.mapPinIcon=r.sDd,this.phoneIcon=r.bcf,this.mailIcon=r.gE4,this.plusIcon=r.FWt,this.editIcon=r.ffu,this.eyeIcon=r.kU3,this.searchIcon=r.vji,this.downloadIcon=r.f5X,this.filterIcon=r.dJT,this.checkCircleIcon=r.rAV,this.xCircleIcon=r.Jpz,this.alertCircleIcon=r.RIJ,this.chevronLeftIcon=r.JGc,this.chevronRightIcon=r.c_$,this.trash2Icon=r.TBR,this.moreVerticalIcon=r.GvN,this.printerIcon=r.xjr,this.breadcrumbItems=[{label:"Inventario",route:"/inventario"},{label:"Farmacias Registradas"}],this.provincias=p.en,this.searchTerm="",this.selectedProvince="",this.selectedStatus="",this.pharmacies=[],this.filteredPharmacies=[],this.showDetailModal=!1,this.showFormModal=!1,this.isEditMode=!1,this.selectedPharmacy=null,this.modalAccionesAbierto=null,this.isLoading=!1,this.currentPage=1,this.itemsPerPage=10,this.paginatedPharmacies=[],this.showRoleSuggestionModal=(0,e.vPA)(!1),this.subscriptions=new f.yU}ngOnInit(){console.log("\u2705 VISTA PRINCIPAL DE FARMACIAS REGISTRADAS - COMPONENTE ACTIVO"),console.log("\u{1f310} URL: http://localhost:4200/inventario/farmacias"),console.log("\u{1f4cd} Esta es la vista que se usa realmente en la aplicaci\xf3n"),this.loadPharmacies(),this.checkRoleSuggestion(),this.subscribeToRoleChanges()}ngOnDestroy(){this.subscriptions.unsubscribe()}loadPharmacies(){this.isLoading=!0,this.pharmacyService.getPharmacies().subscribe(t=>{this.pharmacies=t,this.applyFilters(),this.isLoading=!1})}applyFilters(){this.filteredPharmacies=this.pharmacies.filter(t=>(""===this.searchTerm||this.normalizeText(t.codigo).includes(this.normalizeText(this.searchTerm))||this.normalizeText(t.nombre).includes(this.normalizeText(this.searchTerm))||this.normalizeText(t.direccionEspecifica).includes(this.normalizeText(this.searchTerm))||this.normalizeText(t.telefono).includes(this.normalizeText(this.searchTerm)))&&(""===this.selectedProvince||t.provinciaId===this.selectedProvince)&&(""===this.selectedStatus||t.estado===this.selectedStatus)),this.currentPage=1,this.updatePagination()}updatePagination(){const t=(this.currentPage-1)*this.itemsPerPage;this.paginatedPharmacies=this.filteredPharmacies.slice(t,t+this.itemsPerPage)}normalizeText(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}onSearchChange(){this.applyFilters()}onProvinceChange(){this.applyFilters()}onStatusChange(){this.applyFilters()}getTotalPharmacies(){return this.pharmacies.length}getActivePharmacies(){return this.pharmacies.filter(t=>"activa"===t.estado).length}getInactivePharmacies(){return this.pharmacies.filter(t=>"inactiva"===t.estado).length}getSuspendedPharmacies(){return this.pharmacies.filter(t=>"suspendida"===t.estado).length}getProvinceCount(){return new Set(this.pharmacies.map(a=>a.provinciaId)).size}getFullLocationForPharmacy(t){return(0,p.RS)(t.provinciaId,t.cantonId,t.distritoId)}openNewPharmacyModal(){this.selectedPharmacy=null,this.isEditMode=!1,this.showFormModal=!0}viewPharmacyDetails(t){this.selectedPharmacy=t,this.showDetailModal=!0}editPharmacy(t){this.selectedPharmacy=t,this.isEditMode=!0,this.showFormModal=!0}deletePharmacy(t){if(confirm(`\xbfEst\xe1 seguro de eliminar la farmacia ${t.nombre}?`)){const a=this.pharmacies.findIndex(i=>i.id===t.id);a>-1&&(this.pharmacies.splice(a,1),this.applyFilters(),console.log(`Farmacia ${t.nombre} eliminada del sistema`))}}printPharmacy(t){console.log(`Imprimiendo informaci\xf3n de farmacia ${t.nombre}`),alert(`Imprimiendo informaci\xf3n de ${t.nombre}`)}onCloseDetailModal(){this.showDetailModal=!1,this.selectedPharmacy=null}onCloseFormModal(){this.showFormModal=!1,this.selectedPharmacy=null,this.isEditMode=!1}onEditFromDetail(t){this.showDetailModal=!1,this.editPharmacy(t)}onSavePharmacy(t){if(this.isEditMode&&this.selectedPharmacy){const a=this.pharmacies.findIndex(i=>i.id===this.selectedPharmacy.id);a>-1&&(this.pharmacies[a]={...this.pharmacies[a],...t},this.applyFilters(),console.log("Farmacia actualizada exitosamente"))}else{const a={id:`FARM-${Date.now()}`,...t,fechaRegistro:(new Date).toISOString().split("T")[0]};this.pharmacies.push(a),this.applyFilters(),console.log("Farmacia registrada exitosamente")}this.onCloseFormModal()}toggleAccionesModal(t){this.modalAccionesAbierto=this.modalAccionesAbierto===t?null:t}cerrarModalAcciones(){this.modalAccionesAbierto=null}exportPharmacies(){const t=this.filteredPharmacies.map(a=>({C\u00f3digo:a.codigo,Nombre:a.nombre,Ubicaci\u00f3n:this.getFullLocationForPharmacy(a),Direcci\u00f3n:a.direccionEspecifica,Tel\u00e9fono:a.telefono,Email:a.email,Responsable:a.responsable,Estado:a.estado,"Fecha Registro":a.fechaRegistro}));console.log("Exportar farmacias:",t),alert("Funcionalidad de exportaci\xf3n ser\xe1 implementada pr\xf3ximamente.")}hasActiveFilters(){return""!==this.searchTerm||""!==this.selectedProvince||""!==this.selectedStatus}clearFilters(){this.searchTerm="",this.selectedProvince="",this.selectedStatus="",this.applyFilters()}getStatusBadgeClass(t){return{activa:"bg-green-100 text-green-800 border-green-200",inactiva:"bg-gray-100 text-gray-800 border-gray-200",suspendida:"bg-red-100 text-red-800 border-red-200"}[t]||"bg-gray-100 text-gray-800 border-gray-200"}getStatusLabel(t){return{activa:"Activa",inactiva:"Inactiva",suspendida:"Suspendida"}[t]||"Desconocido"}getStatusDescription(t){switch(t){case"activa":return"Farmacia activa y operativa";case"inactiva":return"Farmacia temporalmente inactiva";case"suspendida":return"Farmacia suspendida por autoridades";default:return"Estado de farmacia desconocido"}}get totalPages(){return Math.ceil(this.filteredPharmacies.length/this.itemsPerPage)}hasPreviousPage(){return this.currentPage>1}hasNextPage(){return this.currentPage<this.totalPages}previousPage(){this.hasPreviousPage()&&(this.currentPage--,this.updatePagination())}nextPage(){this.hasNextPage()&&(this.currentPage++,this.updatePagination())}goToPage(t){t>=1&&t<=this.totalPages&&(this.currentPage=t,this.updatePagination())}getVisiblePages(){const t=this.totalPages,a=this.currentPage,i=[];if(t<=7)for(let n=1;n<=t;n++)i.push(n);else if(a<=4){for(let n=1;n<=5;n++)i.push(n);i.push(-1),i.push(t)}else if(a>=t-3){i.push(1),i.push(-1);for(let n=t-4;n<=t;n++)i.push(n)}else{i.push(1),i.push(-1);for(let n=a-1;n<=a+1;n++)i.push(n);i.push(-1),i.push(t)}return i}onItemsPerPageChange(t){this.itemsPerPage=parseInt(t.target.value),this.currentPage=1,this.updatePagination()}getStartIndex(){return(this.currentPage-1)*this.itemsPerPage+1}getEndIndex(){return Math.min(this.currentPage*this.itemsPerPage,this.filteredPharmacies.length)}formatDate(t){return new Date(t).toLocaleDateString("es-CR",{day:"2-digit",month:"2-digit",year:"numeric"})}isRecentPharmacy(t){const a=new Date(t),i=new Date;return i.setDate(i.getDate()-30),a>=i}trackByPharmacyId(t,a){return a.id}checkRoleSuggestion(){const t=this.roleDemoService.getCurrentSession();console.log("\u{1f527} FarmaciasInventario - checkRoleSuggestion - currentRole:",t.activeRole),"Farmac\xe9utico"!==t.activeRole&&"Administrador"!==t.activeRole?(console.log("\u{1f527} FarmaciasInventario - Showing role suggestion modal for role:",t.activeRole),this.showRoleSuggestionModal.set(!0)):(console.log("\u{1f527} FarmaciasInventario - Not showing modal, user has appropriate role"),this.showRoleSuggestionModal.set(!1))}subscribeToRoleChanges(){this.subscriptions.add(this.roleDemoService.currentSession$.subscribe(t=>{console.log("\u{1f527} FarmaciasInventario - Role changed to:",t.activeRole),this.checkRoleSuggestion()}))}onRoleSuggestionDismiss(){console.log("\u{1f527} FarmaciasInventario - Role suggestion dismissed"),this.showRoleSuggestionModal.set(!1)}onRoleChanged(){console.log("\u{1f527} FarmaciasInventario - Role changed, closing modal"),this.showRoleSuggestionModal.set(!1)}static{this.\u0275fac=function(a){return new(a||o)(e.rXU(b.X),e.rXU(F.z))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-farmacias-inventario"]],standalone:!0,features:[e.aNF],decls:9,vars:14,consts:[["title","Farmacias Registradas","description","Gesti\xf3n y consulta de farmacias del sistema ePrescription en Costa Rica","headerGradient","from-blue-600 to-purple-600",3,"icon","breadcrumbItems"],[1,"space-y-6",3,"click"],["class","flex justify-center items-center py-12",4,"ngIf"],["class","grid grid-cols-2 md:grid-cols-5 gap-4 fade-in-scale","role","region","aria-label","Estad\xedsticas de farmacias del sistema",4,"ngIf"],["class","filter-container rounded-lg shadow p-6 slide-in-right",4,"ngIf"],["class","bg-white rounded-lg shadow overflow-hidden",4,"ngIf"],[3,"closeModal","editPharmacyEvent","isOpen","pharmacy"],[3,"closeModal","savePharmacy","isOpen","pharmacy","isEditMode"],[3,"dismiss","roleChanged","isOpen","suggestedRole","pageName"],[1,"flex","justify-center","items-center","py-12"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"ml-2","text-gray-600"],["role","region","aria-label","Estad\xedsticas de farmacias del sistema",1,"grid","grid-cols-2","md:grid-cols-5","gap-4","fade-in-scale"],["role","group",1,"bg-white","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","cursor-pointer","border-l-4","border-l-blue-500","stagger-animation",2,"--stagger-delay","0"],[1,"p-6"],[1,"flex","items-center","justify-between"],[1,"space-y-1","flex-1"],[1,"text-sm","text-gray-600"],["aria-label","N\xfamero total de farmacias",1,"text-3xl","font-bold","text-gray-900"],["aria-hidden","true",1,"p-3","bg-blue-100","rounded-xl"],["aria-hidden","true",1,"w-8","h-8","text-blue-600",3,"img"],[1,"bg-white","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","cursor-pointer","border-l-4","border-l-green-500","stagger-animation",2,"--stagger-delay","1"],[1,"text-3xl","font-bold","text-gray-900"],[1,"p-3","bg-green-100","rounded-xl"],[1,"w-8","h-8","text-green-600",3,"img"],[1,"bg-white","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","cursor-pointer","border-l-4","border-l-gray-500","stagger-animation",2,"--stagger-delay","2"],[1,"p-3","bg-gray-100","rounded-xl"],[1,"w-8","h-8","text-gray-600",3,"img"],[1,"bg-white","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","cursor-pointer","border-l-4","border-l-yellow-500","stagger-animation",2,"--stagger-delay","3"],[1,"p-3","bg-yellow-100","rounded-xl"],[1,"w-8","h-8","text-yellow-600",3,"img"],[1,"bg-white","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","cursor-pointer","border-l-4","border-l-purple-500","stagger-animation",2,"--stagger-delay","4"],[1,"p-3","bg-purple-100","rounded-xl"],[1,"w-8","h-8","text-purple-600",3,"img"],[1,"filter-container","rounded-lg","shadow","p-6","slide-in-right"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-2"],[1,"w-5","h-5","text-blue-600",3,"img"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600","ml-2"],[1,"inline-flex","items-center","px-4","py-2","bg-blue-600","text-white","text-sm","font-medium","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"w-4","h-4","mr-2",3,"img"],[1,"flex","flex-col","lg:flex-row","gap-4"],[1,"flex-1"],[1,"relative"],["aria-hidden","true",1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","w-4","h-4","text-gray-400",3,"img"],["type","text","id","pharmacy-search","placeholder","Buscar por c\xf3digo, nombre, direcci\xf3n, tel\xe9fono...","aria-label","Buscar farmacias","autocomplete","off",1,"filter-input","w-full","pl-10","pr-4","py-2","rounded-lg","focus-visible",3,"ngModelChange","ngModel"],["aria-label","Filtrar por provincia",1,"filter-select","px-3","py-2","rounded-lg","lg:w-48","focus-visible",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["aria-label","Filtrar por estado de farmacia",1,"filter-select","px-3","py-2","rounded-lg","lg:w-48","focus-visible",3,"ngModelChange","ngModel"],["value","activa"],["value","inactiva"],["value","suspendida"],[1,"px-4","py-2","border","border-gray-300","text-gray-700","rounded-lg","hover:bg-gray-50","transition-colors","flex","items-center","gap-2",3,"click"],[1,"w-4","h-4",3,"img"],["class","px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 flex items-center gap-2 transition-colors",3,"click",4,"ngIf"],[3,"value"],[1,"px-4","py-2","border","border-gray-300","text-gray-700","rounded-lg","hover:bg-gray-50","flex","items-center","gap-2","transition-colors",3,"click"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],["class","text-center py-12",4,"ngIf"],["class","overflow-x-auto","style","max-width: 100vw;",4,"ngIf"],["class","px-6 py-4 border-t border-gray-200 bg-gray-50",4,"ngIf"],[1,"text-center","py-12"],[1,"bg-gray-50","border","border-gray-200","rounded-lg","p-8"],[1,"w-16","h-16","text-gray-400","mx-auto","mb-4",3,"img"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600","mb-6"],[1,"flex","justify-center","gap-3"],[1,"bg-blue-600","text-white","px-4","py-2","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],["class","border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors",3,"click",4,"ngIf"],[1,"border","border-gray-300","text-gray-700","px-4","py-2","rounded-lg","hover:bg-gray-50","transition-colors",3,"click"],[1,"overflow-x-auto",2,"max-width","100vw"],["role","table","aria-label","Tabla de farmacias registradas",1,"w-full","min-w-[1400px]"],[1,"bg-gray-50","sticky","top-0"],["role","row"],["role","columnheader","scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],["role","rowgroup",1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-blue-50/50 cursor-pointer transition-all","role","row","tabindex","0",3,"click","keydown.enter","keydown.space",4,"ngFor","ngForOf","ngForTrackBy"],["role","row","tabindex","0",1,"hover:bg-blue-50/50","cursor-pointer","transition-all",3,"click","keydown.enter","keydown.space"],["role","gridcell",1,"px-6","py-4","whitespace-nowrap"],[1,"flex","items-center"],[1,"flex-shrink-0","w-8","h-8","bg-blue-100","rounded-lg","flex","items-center","justify-center","mr-3"],["aria-hidden","true",1,"w-4","h-4","text-blue-600",3,"img"],[1,"text-sm","font-semibold","text-blue-600"],["class","text-xs text-gray-500",4,"ngIf"],[1,"text-sm","font-medium","text-gray-900"],["role","gridcell",1,"px-6","py-4"],[1,"flex","items-center","gap-1"],["aria-hidden","true",1,"w-4","h-4","text-gray-400",3,"img"],[1,"text-sm","text-gray-900"],[1,"text-sm","text-gray-900","max-w-xs"],["role","status",1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-xs","text-gray-500","mt-1"],["role","gridcell",1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],["title","M\xe1s acciones",1,"p-2","text-gray-400","hover:text-gray-600","rounded-full","hover:bg-gray-100","transition-colors",3,"click"],[1,"w-5","h-5",3,"img"],["class","absolute right-0 top-full mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50",3,"click",4,"ngIf"],[1,"text-xs","text-gray-500"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"],[1,"absolute","right-0","top-full","mt-1","w-48","bg-white","rounded-lg","shadow-lg","border","border-gray-200","z-50",3,"click"],[1,"py-2"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","border-b","border-gray-100"],[1,"w-full","px-4","py-2","text-left","text-sm","text-gray-700","hover:bg-gray-50","flex","items-center","gap-3",3,"click"],[1,"w-4","h-4","text-gray-500",3,"img"],[1,"border-t","border-gray-100","mt-1","pt-1"],[1,"w-full","px-4","py-2","text-left","text-sm","text-red-600","hover:bg-red-50","flex","items-center","gap-3",3,"click"],[1,"w-4","h-4","text-red-500",3,"img"],[1,"px-6","py-4","border-t","border-gray-200","bg-gray-50"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-4"],[1,"text-sm","text-gray-700"],[1,"font-medium"],[1,"flex","items-center","gap-4"],[1,"flex","items-center","gap-2","text-sm","text-gray-700"],[1,"px-2","py-1","border","border-gray-300","rounded","text-sm","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"change","value"],["value","5"],["value","10"],["value","20"],["value","50"],[1,"flex","gap-1"],["title","P\xe1gina anterior",1,"pagination-button","p-2","border","border-gray-300","text-gray-500","rounded","disabled:opacity-50","disabled:cursor-not-allowed","focus-visible",3,"click","disabled"],["class","pagination-button px-3 py-2 rounded focus-visible",3,"ngClass","click",4,"ngFor","ngForOf"],["title","P\xe1gina siguiente",1,"pagination-button","p-2","border","border-gray-300","text-gray-700","rounded","disabled:opacity-50","disabled:cursor-not-allowed","focus-visible",3,"click","disabled"],[1,"pagination-button","px-3","py-2","rounded","focus-visible",3,"click","ngClass"]],template:function(a,i){1&a&&(e.j41(0,"app-page-layout",0)(1,"div",1),e.bIt("click",function(){return i.cerrarModalAcciones()}),e.DNE(2,x,4,0,"div",2)(3,y,51,11,"div",3)(4,C,33,12,"div",4)(5,O,4,3,"div",5),e.j41(6,"app-pharmacy-detail-modal",6),e.bIt("closeModal",function(){return i.onCloseDetailModal()})("editPharmacyEvent",function(d){return i.onEditFromDetail(d)}),e.k0s(),e.j41(7,"app-pharmacy-form-modal",7),e.bIt("closeModal",function(){return i.onCloseFormModal()})("savePharmacy",function(d){return i.onSavePharmacy(d)}),e.k0s(),e.j41(8,"app-role-suggestion-modal",8),e.bIt("dismiss",function(){return i.onRoleSuggestionDismiss()})("roleChanged",function(){return i.onRoleChanged()}),e.k0s()()()),2&a&&(e.Y8G("icon",i.building2Icon)("breadcrumbItems",i.breadcrumbItems),e.R7$(2),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",!i.isLoading),e.R7$(),e.Y8G("ngIf",!i.isLoading),e.R7$(),e.Y8G("ngIf",!i.isLoading),e.R7$(),e.Y8G("isOpen",i.showDetailModal)("pharmacy",i.selectedPharmacy),e.R7$(),e.Y8G("isOpen",i.showFormModal)("pharmacy",i.selectedPharmacy)("isEditMode",i.isEditMode),e.R7$(),e.Y8G("isOpen",i.showRoleSuggestionModal())("suggestedRole","Farmac\xe9utico")("pageName","inventario-farmacias"))},dependencies:[g.MD,g.YU,g.Sq,g.bT,l.YN,l.xH,l.y7,l.me,l.wz,l.BC,l.vS,r.flO,r.WGl,_.Z,h.E,u.t,v.J],styles:[".fade-in-scale[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInScale .6s ease-out}@keyframes _ngcontent-%COMP%_fadeInScale{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.stagger-animation[_ngcontent-%COMP%]{opacity:0;animation:_ngcontent-%COMP%_staggerFadeIn .5s ease-out forwards;animation-delay:calc(var(--stagger-delay) * .1s)}@keyframes _ngcontent-%COMP%_staggerFadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.slide-in-right[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInRight .4s ease-out}@keyframes _ngcontent-%COMP%_slideInRight{0%{opacity:0;transform:translate(20px)}to{opacity:1;transform:translate(0)}}.stat-card[_ngcontent-%COMP%]{transition:all .3s ease;border:1px solid #e5e7eb}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px -3px #0000001a,0 4px 6px -2px #0000000d}.stat-icon[_ngcontent-%COMP%]{transition:transform .2s ease}.stat-card[_ngcontent-%COMP%]:hover   .stat-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.stat-total[_ngcontent-%COMP%]:hover{border-color:#3b82f6}.stat-active[_ngcontent-%COMP%]:hover{border-color:#10b981}.stat-inactive[_ngcontent-%COMP%]:hover{border-color:#6b7280}.stat-suspended[_ngcontent-%COMP%]:hover{border-color:#f59e0b}.stat-provinces[_ngcontent-%COMP%]:hover{border-color:#8b5cf6}.filter-container[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb}.filter-input[_ngcontent-%COMP%]{border:1px solid #d1d5db;transition:all .2s ease}.filter-input[_ngcontent-%COMP%]:focus{outline:none;ring:2px;ring-color:#3b82f6;border-color:#3b82f6}.filter-select[_ngcontent-%COMP%]{border:1px solid #d1d5db;transition:all .2s ease}.filter-select[_ngcontent-%COMP%]:focus{outline:none;ring:2px;ring-color:#3b82f6;border-color:#3b82f6}.pagination-button[_ngcontent-%COMP%]{transition:all .2s ease}.pagination-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f3f4f6}.pagination-button.active[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.pagination-button.active[_ngcontent-%COMP%]:hover{background-color:#2563eb}.focus-visible[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}.hover\\:bg-blue-50\\/50[_ngcontent-%COMP%]:hover{background-color:#eff6ff80}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (prefers-reduced-motion: reduce){.fade-in-scale[_ngcontent-%COMP%], .stagger-animation[_ngcontent-%COMP%], .slide-in-right[_ngcontent-%COMP%], .stat-card[_ngcontent-%COMP%], .stat-icon[_ngcontent-%COMP%], .filter-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%], .pagination-button[_ngcontent-%COMP%]{animation:none;transition:none}}"]})}}return o})()}}]);