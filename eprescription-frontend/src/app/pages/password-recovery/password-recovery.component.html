<div class="min-h-screen relative overflow-hidden">
  <!-- Fondo con gradiente m칠dico profesional -->
  <div class="absolute inset-0 bg-gradient-to-br from-blue-50 via-white to-cyan-50"></div>
  
  <!-- Patr칩n de grid m칠dico sutil -->
  <div class="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAxMCAwIEwgMCAwIDAgMTAiIGZpbGw9Im5vbmUiIHN0cm9rZT0icmdiYSgzNywgOTksIDE5NSwgMC4wNSkiIHN0cm9rZS13aWR0aD0iMSIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNncmlkKSIvPjwvc3ZnPg==')] opacity-40"></div>
  
  <!-- C칤rculos decorativos m칠dicos -->
  <div class="absolute top-0 right-0 w-96 h-96 bg-blue-400/10 rounded-full blur-3xl animate-pulse"></div>
  <div class="absolute bottom-0 left-0 w-96 h-96 bg-cyan-400/10 rounded-full blur-3xl animate-pulse"></div>
  <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-gradient-to-br from-blue-300/5 to-cyan-300/5 rounded-full blur-3xl"></div>

  <div class="relative min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-md">
      <!-- Logo y t칤tulo -->
      <div class="text-center mb-8">
        <div [class]="'inline-flex items-center justify-center w-20 h-20 rounded-2xl mb-4 shadow-2xl ' + 
          (step === 'success' 
            ? 'bg-gradient-to-br from-green-600 to-emerald-600' 
            : 'bg-gradient-to-br from-blue-600 to-cyan-600')">
          <!-- CheckCircle2 icon para success -->
          <svg *ngIf="step === 'success'" class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          <!-- KeyRound icon para otros pasos -->
          <svg *ngIf="step !== 'success'" class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
          </svg>
        </div>
        <h1 class="text-blue-600 mb-2 text-3xl font-bold">
          {{ step === 'success' ? 'Cambio exitoso' : 'Recuperar contrase침a' }}
        </h1>
        <p class="text-gray-600 text-lg">
          <span *ngIf="step === 'request'">Te ayudaremos a recuperar el acceso</span>
          <span *ngIf="step === 'sent'">Revisa tu correo electr칩nico</span>
          <span *ngIf="step === 'reset'">Crea una nueva contrase침a segura</span>
          <span *ngIf="step === 'success'">Ahora puedes iniciar sesi칩n</span>
        </p>
      </div>

      <div class="shadow-2xl border border-gray-200 backdrop-blur-sm bg-white/95 rounded-lg">
        
        <!-- PASO 1: Solicitar recuperaci칩n -->
        <div *ngIf="step === 'request'">
          <div class="space-y-3 pb-6 p-6">
            <h2 class="text-2xl font-bold">Solicitar recuperaci칩n</h2>
            <p class="text-base text-gray-600">
              Ingresa tu correo electr칩nico registrado
            </p>
          </div>
          
          <div class="pt-0 p-6">
            <!-- Mensaje de error -->
            <div *ngIf="error" class="mb-4 p-3 bg-red-50 border border-red-200 rounded-md">
              <div class="flex items-center">
                <svg class="h-4 w-4 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <p class="text-sm text-red-800">{{ error }}</p>
              </div>
            </div>

            <form [formGroup]="requestForm" (ngSubmit)="onRequestRecovery()" class="space-y-5">
              <div class="space-y-2">
                <label for="email" class="block text-sm font-medium text-gray-700">Correo electr칩nico</label>
                <div class="relative">
                  <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                  </svg>
                  <input
                    id="email"
                    type="email"
                    placeholder="tu.correo@hospital.cr"
                    formControlName="email"
                    [disabled]="loading"
                    required
                    class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    autofocus
                  />
                </div>
              </div>

              <div class="p-3 bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-md">
                <div class="flex items-start">
                  <svg class="h-4 w-4 text-blue-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                  </svg>
                  <p class="text-sm text-blue-900">
                    Por seguridad, si el correo est치 registrado, te enviaremos un enlace para restablecer tu contrase침a. El enlace ser치 v치lido por 15 minutos.
                  </p>
                </div>
              </div>

              <button 
                type="submit" 
                class="w-full h-11 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-medium rounded-md shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed" 
                [disabled]="loading || requestForm.invalid"
              >
                <div *ngIf="loading" class="flex items-center justify-center gap-2">
                  <div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                  Enviando...
                </div>
                <div *ngIf="!loading" class="flex items-center justify-center">
                  <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                  </svg>
                  Enviar enlace de recuperaci칩n
                </div>
              </button>
            </form>

            <div class="mt-6 pt-6 border-t border-gray-200">
              <button
                type="button"
                class="w-full flex items-center justify-center gap-2 text-gray-600 hover:text-gray-800"
                (click)="goBackToLogin()"
                [disabled]="loading"
              >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                </svg>
                Volver al inicio de sesi칩n
              </button>
            </div>
          </div>
        </div>

        <!-- PASO 2: Enlace enviado -->
        <div *ngIf="step === 'sent'">
          <div class="space-y-3 pb-6 p-6">
            <h2 class="text-2xl font-bold">Revisa tu correo</h2>
            <p class="text-base text-gray-600">
              Enviamos las instrucciones a tu email
            </p>
          </div>
          
          <div class="pt-0 p-6">
            <div class="mb-6 p-3 bg-green-50 border border-green-200 rounded-md">
              <div class="flex items-center">
                <svg class="h-4 w-4 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <p class="text-sm text-green-800">
                  Si el correo est치 registrado en nuestro sistema, recibir치s un enlace para restablecer tu contrase침a.
                </p>
              </div>
            </div>

            <div class="bg-gradient-to-br from-blue-50 to-cyan-50 border border-blue-200 rounded-lg p-8 text-center space-y-4 shadow-inner">
              <div class="w-20 h-20 bg-gradient-to-br from-blue-600 to-cyan-600 rounded-2xl flex items-center justify-center mx-auto shadow-lg">
                <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                </svg>
              </div>
              <div class="space-y-2">
                <h3 class="text-xl font-semibold">Revisa tu bandeja de entrada</h3>
                <p class="text-sm text-gray-600">
                  Hemos enviado un correo a <strong class="text-gray-900">{{ emailSent }}</strong> con un enlace para restablecer tu contrase침a.
                </p>
              </div>
              <div class="flex items-center justify-center gap-4 text-sm pt-4">
                <div class="flex items-center gap-2 text-yellow-600">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  <span>Expira en <strong>15 min</strong></span>
                </div>
                <div class="w-px h-4 bg-gray-300"></div>
                <div class="flex items-center gap-2 text-gray-500">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  <span>Revisa spam</span>
                </div>
              </div>
            </div>

            <div class="mt-8 space-y-3">
              <!-- BOT칍N DEMO: Simular clic en link del email -->
              <button
                type="button"
                class="w-full h-11 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-medium rounded-md shadow-lg hover:shadow-xl transition-all"
                (click)="simulateEmailLink()"
              >
                <div class="flex items-center justify-center">
                  <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  游댕 Simular clic en link del email (DEMO)
                </div>
              </button>
              
              <button
                type="button"
                class="w-full h-11 border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium rounded-md transition-all"
                (click)="requestAnotherLink()"
                [disabled]="loading"
              >
                <div class="flex items-center justify-center">
                  <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                  </svg>
                  Solicitar otro enlace
                </div>
              </button>
              
              <button
                type="button"
                class="w-full flex items-center justify-center gap-2 text-gray-600 hover:text-gray-800"
                (click)="goBackToLogin()"
              >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                </svg>
                Volver al inicio de sesi칩n
              </button>
            </div>
          </div>
        </div>

        <!-- PASO 3: Crear nueva contrase침a -->
        <div *ngIf="step === 'reset'">
          <div class="space-y-3 pb-6 p-6">
            <h2 class="text-2xl font-bold">Crear nueva contrase침a</h2>
            <p class="text-base text-gray-600">
              Tu contrase침a debe cumplir con nuestros requisitos de seguridad
            </p>
          </div>
          
          <div class="pt-0 p-6">
            <!-- Mensajes de error/칠xito -->
            <div *ngIf="error" class="mb-4 p-3 bg-red-50 border border-red-200 rounded-md">
              <div class="flex items-center">
                <svg class="h-4 w-4 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <p class="text-sm text-red-800">{{ error }}</p>
              </div>
            </div>

            <div *ngIf="success" class="mb-4 p-3 bg-green-50 border border-green-200 rounded-md">
              <div class="flex items-center">
                <svg class="h-4 w-4 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <p class="text-sm text-green-800">{{ success }}</p>
              </div>
            </div>

            <form [formGroup]="resetForm" (ngSubmit)="onResetPassword()" class="space-y-5">
              <div class="space-y-2">
                <label for="new-password" class="block text-sm font-medium text-gray-700">Nueva contrase침a</label>
                <div class="relative">
                  <input
                    id="new-password"
                    [type]="showNewPassword ? 'text' : 'password'"
                    placeholder="M칤nimo 12 caracteres"
                    formControlName="newPassword"
                    [disabled]="loading"
                    required
                    class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    autofocus
                  />
                  <button
                    type="button"
                    (click)="togglePasswordVisibility('new')"
                    class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600"
                    [disabled]="loading"
                  >
                    <svg *ngIf="!showNewPassword" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                    </svg>
                    <svg *ngIf="showNewPassword" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"/>
                    </svg>
                  </button>
                </div>
                
                <!-- Indicador de fortaleza -->
                <div *ngIf="resetForm.get('newPassword')?.value" class="space-y-1">
                  <div class="flex items-center justify-between text-xs">
                    <span class="text-gray-500">Fortaleza</span>
                    <span [class]="'font-medium ' + 
                      (getPasswordStrength(resetForm.get('newPassword')?.value).strength < 50 ? 'text-red-600' :
                       getPasswordStrength(resetForm.get('newPassword')?.value).strength < 70 ? 'text-yellow-600' :
                       'text-green-600')">
                      {{ getPasswordStrength(resetForm.get('newPassword')?.value).label }}
                    </span>
                  </div>
                  <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                    <div 
                      [class]="'h-full transition-all ' + getPasswordStrength(resetForm.get('newPassword')?.value).color"
                      [style.width.%]="getPasswordStrength(resetForm.get('newPassword')?.value).strength">
                    </div>
                  </div>
                </div>
              </div>

              <div class="space-y-2">
                <label for="confirm-password" class="block text-sm font-medium text-gray-700">Confirmar contrase침a</label>
                <div class="relative">
                  <input
                    id="confirm-password"
                    [type]="showConfirmPassword ? 'text' : 'password'"
                    placeholder="Repite tu contrase침a"
                    formControlName="confirmPassword"
                    [disabled]="loading"
                    required
                    class="w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                  />
                  <button
                    type="button"
                    (click)="togglePasswordVisibility('confirm')"
                    class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600"
                    [disabled]="loading"
                  >
                    <svg *ngIf="!showConfirmPassword" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                    </svg>
                    <svg *ngIf="showConfirmPassword" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"/>
                    </svg>
                  </button>
                </div>
              </div>

              <!-- Requisitos -->
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 space-y-2">
                <p class="text-sm font-medium">Requisitos de contrase침a:</p>
                <ul class="text-sm text-gray-600 space-y-1">
                  <li class="flex items-start gap-2">
                    <svg [class]="'w-4 h-4 mt-0.5 flex-shrink-0 ' + 
                      (checkPasswordRequirement(resetForm.get('newPassword')?.value || '', 'length') ? 'text-green-600' : 'text-gray-400')" 
                      fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    M칤nimo 12 caracteres
                  </li>
                  <li class="flex items-start gap-2">
                    <svg [class]="'w-4 h-4 mt-0.5 flex-shrink-0 ' + 
                      (checkPasswordRequirement(resetForm.get('newPassword')?.value || '', 'mixed') ? 'text-green-600' : 'text-gray-400')" 
                      fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Incluir may칰sculas, min칰sculas y n칰meros
                  </li>
                  <li class="flex items-start gap-2">
                    <svg [class]="'w-4 h-4 mt-0.5 flex-shrink-0 ' + 
                      (checkPasswordRequirement(resetForm.get('newPassword')?.value || '', 'special') ? 'text-green-600' : 'text-gray-400')" 
                      fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Al menos un s칤mbolo especial (!&#64;#$%^&*)
                  </li>
                </ul>
              </div>

              <div class="p-3 bg-blue-50 border border-blue-200 rounded-md">
                <div class="flex items-start">
                  <svg class="h-4 w-4 text-blue-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  <p class="text-sm text-blue-900">
                    Al restablecer tu contrase침a, se cerrar치n todas tus sesiones activas por seguridad.
                  </p>
                </div>
              </div>

              <button 
                type="submit" 
                class="w-full h-11 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-medium rounded-md shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed" 
                [disabled]="loading || resetForm.invalid"
              >
                <div *ngIf="loading" class="flex items-center justify-center gap-2">
                  <div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                  Actualizando...
                </div>
                <div *ngIf="!loading" class="flex items-center justify-center">
                  <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  Actualizar contrase침a
                </div>
              </button>
            </form>

            <div class="mt-6">
              <button
                type="button"
                class="w-full flex items-center justify-center gap-2 text-gray-600 hover:text-gray-800 h-11"
                (click)="goBackToLogin()"
                [disabled]="loading"
              >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                </svg>
                Volver al inicio de sesi칩n
              </button>
            </div>
          </div>
        </div>

        <!-- PASO 4: Confirmaci칩n de 칠xito -->
        <div *ngIf="step === 'success'">
          <div class="space-y-3 pb-6 p-6">
            <h2 class="text-2xl font-bold">춰Cambio completado con 칠xito!</h2>
            <p class="text-base text-gray-600">
              Por seguridad, cerramos todas tus sesiones activas
            </p>
          </div>
          
          <div class="pt-0 p-6">
            <div class="bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-lg p-8 text-center space-y-6 shadow-inner">
              <div class="w-24 h-24 bg-gradient-to-br from-green-600 to-emerald-600 rounded-full flex items-center justify-center mx-auto shadow-lg">
                <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
              </div>
              
              <div class="space-y-3">
                <h3 class="text-xl text-green-900 font-semibold">Tu cuenta est치 protegida</h3>
                <p class="text-sm text-green-800 leading-relaxed">
                  Deber치s iniciar sesi칩n nuevamente usando tu nueva contrase침a. 
                  Esto garantiza que solo t칰 tengas acceso a tu cuenta.
                </p>
              </div>

              <div class="bg-white/60 backdrop-blur-sm rounded-lg p-4 space-y-2">
                <p class="text-sm font-medium text-green-900">Medidas de seguridad aplicadas:</p>
                <ul class="text-sm text-green-800 space-y-1">
                  <li class="flex items-start gap-2">
                    <svg class="w-4 h-4 mt-0.5 flex-shrink-0 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Contrase침a actualizada correctamente
                  </li>
                  <li class="flex items-start gap-2">
                    <svg class="w-4 h-4 mt-0.5 flex-shrink-0 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Todas las sesiones cerradas
                  </li>
                  <li class="flex items-start gap-2">
                    <svg class="w-4 h-4 mt-0.5 flex-shrink-0 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Notificaci칩n enviada a tu correo
                  </li>
                  <li class="flex items-start gap-2">
                    <svg class="w-4 h-4 mt-0.5 flex-shrink-0 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Registro en auditor칤a de seguridad
                  </li>
                </ul>
              </div>
            </div>

            <div class="mt-6 p-3 bg-blue-50 border border-blue-200 rounded-md">
              <div class="flex items-start">
                <svg class="h-4 w-4 text-blue-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                </svg>
                <p class="text-sm text-blue-900">
                  <strong class="font-semibold">Recomendaci칩n de seguridad:</strong> Si no solicitaste este cambio, 
                  contacta de inmediato al administrador del sistema.
                </p>
              </div>
            </div>

            <button 
              (click)="goBackToLogin()"
              class="w-full h-12 mt-6 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-medium rounded-md shadow-lg hover:shadow-xl transition-all" 
            >
              <div class="flex items-center justify-center">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Continuar al inicio de sesi칩n
              </div>
            </button>

            <p class="text-center text-sm text-gray-500 mt-4">
              Ser치s redirigido a la pantalla de login donde podr치s usar tu nueva contrase침a
            </p>
          </div>
        </div>
      </div>

      <!-- Footer de seguridad y certificaciones -->
      <div class="mt-8 space-y-4">
        <!-- Badges de certificaci칩n -->
        <div class="flex flex-wrap justify-center gap-2">
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white/80 backdrop-blur-sm border border-gray-200">
            HL7 Compatible
          </span>
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white/80 backdrop-blur-sm border border-gray-200">
            FHIR R4
          </span>
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white/80 backdrop-blur-sm border border-gray-200">
            HIPAA Compliant
          </span>
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white/80 backdrop-blur-sm border border-gray-200">
            FDA Certified
          </span>
        </div>

        <!-- Informaci칩n de seguridad -->
        <div class="text-center space-y-2">
          <div class="flex items-center justify-center gap-2 text-xs text-gray-500">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
            </svg>
            <span>Conforme a pol칤ticas de seguridad OWASP y NIST 800-63B</span>
          </div>
          <div class="flex items-center justify-center gap-2 text-xs text-gray-500">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5Z"/>
            </svg>
            <span>ePrescription - Sistema Hospitalario de Recetas M칠dicas</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>