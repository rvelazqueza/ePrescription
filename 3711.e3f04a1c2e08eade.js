"use strict";(self.webpackChunkeprescription_angular=self.webpackChunkeprescription_angular||[]).push([[3711],{3711:(L,N,n)=>{n.d(N,{X:()=>b});var p=n(4412),l=n(7673),C=n(1985),u=n(6354),d=n(204),h=n(8141),g=n(5558),v=n(4438);let b=(()=>{class y{constructor(){this.selectedPatientSubject=new p.t(null),this.selectedPatient$=this.selectedPatientSubject.asObservable(),this.mockPatients=[{id:"1",fullName:"Mar\xeda Isabel L\xf3pez Garc\xeda",firstName:"Mar\xeda Isabel",firstLastName:"L\xf3pez",secondLastName:"Garc\xeda",idType:"C\xe9dula Nacional",idNumber:"1-0234-0567",birthDate:"1985-03-15",age:40,gender:"F",bloodType:"O+",phone:"3001234567",email:"maria.lopez@email.com",address:"Calle 123 #45-67",city:"San Jos\xe9",country:"Costa Rica",allergies:["Penicilina","Mariscos"],chronicConditions:["Hipertensi\xf3n arterial"],currentMedications:["Losart\xe1n 50mg","Hidroclorotiazida 12.5mg"],registrationDate:"2023-01-15",status:"active",lastVisit:"2024-10-10"},{id:"2",fullName:"Carlos Alberto Mendoza Silva",firstName:"Carlos Alberto",firstLastName:"Mendoza",secondLastName:"Silva",idType:"CC",idNumber:"80987654",birthDate:"1978-07-22",age:46,gender:"M",bloodType:"A+",phone:"3109876543",email:"carlos.mendoza@email.com",address:"Carrera 45 #12-34",city:"Medell\xedn",country:"Colombia",allergies:[],chronicConditions:["Diabetes Tipo 2"],currentMedications:["Metformina 850mg","Glibenclamida 5mg"],registrationDate:"2023-02-20",status:"active",lastVisit:"2024-10-08"},{id:"3",fullName:"Ana Sof\xeda Herrera L\xf3pez",firstName:"Ana Sof\xeda",firstLastName:"Herrera",secondLastName:"L\xf3pez",idType:"CC",idNumber:"63456789",birthDate:"1992-11-08",age:31,gender:"F",bloodType:"B+",phone:"3156789012",email:"ana.herrera@email.com",address:"Avenida 68 #89-12",city:"Cali",country:"Colombia",allergies:["Ibuprofeno"],chronicConditions:[],currentMedications:[],registrationDate:"2023-03-10",status:"active",lastVisit:"2024-10-05"},{id:"4",fullName:"Roberto Jos\xe9 Vargas Castro",firstName:"Roberto Jos\xe9",firstLastName:"Vargas",secondLastName:"Castro",idType:"CC",idNumber:"71234567",birthDate:"1965-05-30",age:59,gender:"M",bloodType:"AB+",phone:"3023456789",email:"roberto.vargas@email.com",address:"Calle 50 #23-45",city:"Barranquilla",country:"Colombia",allergies:["Sulfonamidas"],chronicConditions:["Hipertensi\xf3n","Colesterol Alto"],currentMedications:["Enalapril 10mg","Atorvastatina 20mg"],registrationDate:"2023-04-05",status:"active",lastVisit:"2024-10-03"},{id:"5",fullName:"Luc\xeda Patricia Ram\xedrez Torres",firstName:"Luc\xeda Patricia",firstLastName:"Ram\xedrez",secondLastName:"Torres",idType:"CC",idNumber:"55678901",birthDate:"1988-12-12",age:35,gender:"F",bloodType:"O-",phone:"3187890123",email:"lucia.ramirez@email.com",address:"Transversal 15 #67-89",city:"Bucaramanga",country:"Colombia",allergies:[],chronicConditions:["Asma"],currentMedications:["Salbutamol inhalador"],registrationDate:"2023-05-18",status:"active",lastVisit:"2024-09-28"},{id:"6",fullName:"Diego Fernando Morales P\xe9rez",firstName:"Diego Fernando",firstLastName:"Morales",secondLastName:"P\xe9rez",idType:"CC",idNumber:"79345612",birthDate:"1990-04-18",age:34,gender:"M",bloodType:"A-",phone:"3201234567",email:"diego.morales@email.com",address:"Calle 72 #34-56",city:"Bogot\xe1",country:"Colombia",allergies:["Aspirina"],chronicConditions:[],currentMedications:[],registrationDate:"2023-06-22",status:"active",lastVisit:"2024-09-25"},{id:"7",fullName:"Carmen Rosa Jim\xe9nez Vega",firstName:"Carmen Rosa",firstLastName:"Jim\xe9nez",secondLastName:"Vega",idType:"CC",idNumber:"41567890",birthDate:"1975-09-03",age:49,gender:"F",bloodType:"B-",phone:"3134567890",email:"carmen.jimenez@email.com",address:"Carrera 30 #78-90",city:"Medell\xedn",country:"Colombia",allergies:[],chronicConditions:["Artritis Reumatoide"],currentMedications:["Metotrexato 15mg","\xc1cido F\xf3lico 5mg"],registrationDate:"2023-07-10",status:"active",lastVisit:"2024-09-20"},{id:"8",fullName:"Andr\xe9s Felipe Ruiz G\xf3mez",firstName:"Andr\xe9s Felipe",firstLastName:"Ruiz",secondLastName:"G\xf3mez",idType:"CC",idNumber:"98765432",birthDate:"1995-01-25",age:29,gender:"M",bloodType:"O+",phone:"3167890123",email:"andres.ruiz@email.com",address:"Diagonal 45 #23-67",city:"Cali",country:"Colombia",allergies:["L\xe1tex"],chronicConditions:[],currentMedications:[],registrationDate:"2023-08-15",status:"active",lastVisit:"2024-09-18"},{id:"9",fullName:"Patricia Isabel Delgado Moreno",firstName:"Patricia Isabel",firstLastName:"Delgado",secondLastName:"Moreno",idType:"CC",idNumber:"36789012",birthDate:"1982-06-14",age:42,gender:"F",bloodType:"AB-",phone:"3045678901",email:"patricia.delgado@email.com",address:"Avenida 19 #56-78",city:"Cartagena",country:"Colombia",allergies:["Contraste Yodado"],chronicConditions:["Hipotiroidismo"],currentMedications:["Levotiroxina 100mcg"],registrationDate:"2023-09-05",status:"active",lastVisit:"2024-09-15"},{id:"10",fullName:"Javier Eduardo S\xe1nchez Ortiz",firstName:"Javier Eduardo",firstLastName:"S\xe1nchez",secondLastName:"Ortiz",idType:"CC",idNumber:"85432109",birthDate:"1987-10-07",age:37,gender:"M",bloodType:"A+",phone:"3198765432",email:"javier.sanchez@email.com",address:"Calle 85 #12-34",city:"Pereira",country:"Colombia",allergies:[],chronicConditions:["Migra\xf1a Cr\xf3nica"],currentMedications:["Sumatript\xe1n 50mg"],registrationDate:"2023-10-12",status:"active",lastVisit:"2024-09-12"},{id:"11",fullName:"M\xf3nica Alejandra Castro Restrepo",firstName:"M\xf3nica Alejandra",firstLastName:"Castro",secondLastName:"Restrepo",idType:"CC",idNumber:"47890123",birthDate:"1993-08-29",age:31,gender:"F",bloodType:"O-",phone:"3112345678",email:"monica.castro@email.com",address:"Transversal 25 #67-89",city:"Manizales",country:"Colombia",allergies:["Amoxicilina"],chronicConditions:[],currentMedications:[],registrationDate:"2023-11-20",status:"active",lastVisit:"2024-09-10"},{id:"12",fullName:"Fernando Jos\xe9 Aguilar Rojas",firstName:"Fernando Jos\xe9",firstLastName:"Aguilar",secondLastName:"Rojas",idType:"CC",idNumber:"92345678",birthDate:"1970-02-16",age:54,gender:"M",bloodType:"B+",phone:"3076543210",email:"fernando.aguilar@email.com",address:"Carrera 15 #89-01",city:"Santa Marta",country:"Colombia",allergies:[],chronicConditions:["EPOC","Hipertensi\xf3n"],currentMedications:["Salbutamol","Amlodipino 5mg"],registrationDate:"2023-12-08",status:"active",lastVisit:"2024-09-08"},{id:"13",fullName:"Claudia Marcela Ospina Vargas",firstName:"Claudia Marcela",firstLastName:"Ospina",secondLastName:"Vargas",idType:"CC",idNumber:"58901234",birthDate:"1986-12-05",age:37,gender:"F",bloodType:"A-",phone:"3089012345",email:"claudia.ospina@email.com",address:"Avenida 68 #45-23",city:"Ibagu\xe9",country:"Colombia",allergies:["Diclofenaco"],chronicConditions:["Fibromialgia"],currentMedications:["Pregabalina 150mg","Duloxetina 60mg"],registrationDate:"2024-01-15",status:"active",lastVisit:"2024-09-05"},{id:"14",fullName:"Ricardo Alejandro Herrera Mu\xf1oz",firstName:"Ricardo Alejandro",firstLastName:"Herrera",secondLastName:"Mu\xf1oz",idType:"CC",idNumber:"73456789",birthDate:"1991-07-11",age:33,gender:"M",bloodType:"AB+",phone:"3156789012",email:"ricardo.herrera@email.com",address:"Calle 45 #78-90",city:"Villavicencio",country:"Colombia",allergies:[],chronicConditions:[],currentMedications:[],registrationDate:"2024-02-28",status:"active",lastVisit:"2024-09-02"},{id:"15",fullName:"Esperanza del Carmen Moreno Silva",firstName:"Esperanza del Carmen",firstLastName:"Moreno",secondLastName:"Silva",idType:"CC",idNumber:"29876543",birthDate:"1968-11-23",age:55,gender:"F",bloodType:"O+",phone:"3023456789",email:"esperanza.moreno@email.com",address:"Diagonal 78 #34-56",city:"Pasto",country:"Colombia",allergies:["Morfina"],chronicConditions:["Osteoporosis","Hipertensi\xf3n"],currentMedications:["Alendronato 70mg","Losart\xe1n 100mg","Calcio + Vitamina D"],registrationDate:"2024-03-10",status:"active",lastVisit:"2024-08-30"}],this.mockPrescriptions=[{id:"RX001",prescriptionNumber:"RX-2024-001",date:"2024-10-10",doctor:{name:"Dr. Ana Mar\xeda L\xf3pez",specialty:"Medicina Interna",licenseNumber:"ML-12345",institution:"Hospital San Jos\xe9"},medications:[{name:"Losart\xe1n",dosage:"50mg",frequency:"1 vez al d\xeda",duration:"30 d\xedas",instructions:"Tomar en ayunas"},{name:"Aspirina",dosage:"100mg",frequency:"1 vez al d\xeda",duration:"30 d\xedas",instructions:"Tomar con alimentos"}],status:"dispensed",diagnosis:"Hipertensi\xf3n arterial",notes:"Control en 30 d\xedas",dispensedDate:"2024-10-11",expirationDate:"2024-11-10",pharmacyInfo:{name:"Farmacia Central",address:"Calle 123 #45-67"}},{id:"RX002",prescriptionNumber:"RX-2024-002",date:"2024-10-08",doctor:{name:"Dr. Carlos Mendoza",specialty:"Endocrinolog\xeda",licenseNumber:"EN-67890"},medications:[{name:"Metformina",dosage:"850mg",frequency:"2 veces al d\xeda",duration:"60 d\xedas",instructions:"Tomar con las comidas principales"}],status:"dispensed",diagnosis:"Diabetes Mellitus Tipo 2",dispensedDate:"2024-10-09",expirationDate:"2024-12-08"},{id:"RX003",prescriptionNumber:"RX-2024-003",date:"2024-10-05",doctor:{name:"Dr. Patricia Herrera",specialty:"Medicina General"},medications:[{name:"Ibuprofeno",dosage:"400mg",frequency:"Cada 8 horas",duration:"5 d\xedas",instructions:"Solo si hay dolor"}],status:"expired",diagnosis:"Dolor muscular",expirationDate:"2024-10-12"},{id:"RX004",prescriptionNumber:"RX-2024-004",date:"2024-10-15",doctor:{name:"Dr. Roberto Vargas",specialty:"Cardiolog\xeda"},medications:[{name:"Enalapril",dosage:"10mg",frequency:"2 veces al d\xeda",duration:"30 d\xedas"},{name:"Atorvastatina",dosage:"20mg",frequency:"1 vez al d\xeda por la noche",duration:"30 d\xedas"}],status:"pending",diagnosis:"Hipertensi\xf3n y dislipidemia",expirationDate:"2024-11-15"},{id:"RX005",prescriptionNumber:"RX-2024-005",date:"2024-09-28",doctor:{name:"Dr. Luc\xeda Ram\xedrez",specialty:"Neumolog\xeda"},medications:[{name:"Salbutamol",dosage:"100mcg/puff",frequency:"2 puffs cada 6 horas",duration:"30 d\xedas",instructions:"Usar inhalador con espaciador"}],status:"dispensed",diagnosis:"Asma bronquial",dispensedDate:"2024-09-29",expirationDate:"2024-10-28"}],this.patientPrescriptions={1:["RX001","RX002","RX003","RX004","RX005"],2:["RX002"],3:["RX003"],4:["RX004"],5:["RX005"],6:[],7:[],8:[],9:[],10:[],11:[],12:[],13:[],14:[],15:[]}}getRecentPatients(){return(0,l.of)(this.mockPatients).pipe((0,u.T)(e=>e.map(t=>({...t,lastVisitDate:t.lastVisit||"2024-09-15",visitCount:Math.floor(20*Math.random())+1,lastPrescriptionId:`RX-${Math.random().toString(36).substring(2,11).toUpperCase()}`}))),(0,u.T)(e=>e.sort((t,i)=>new Date(i.lastVisitDate).getTime()-new Date(t.lastVisitDate).getTime())),(0,d.c)(300),(0,h.M)(e=>console.log(`Loaded ${e.length} recent patients`)))}searchPatients(e,t="name"){return!e||e.length<2?(0,l.of)({patients:[],totalCount:0,hasMore:!1}):(0,l.of)(this.mockPatients).pipe((0,u.T)(i=>i.filter(a=>{const s=e.toLowerCase().trim();switch(t){case"name":return a.fullName.toLowerCase().includes(s)||a.firstName.toLowerCase().includes(s)||a.firstLastName.toLowerCase().includes(s)||a.secondLastName&&a.secondLastName.toLowerCase().includes(s);case"idNumber":return a.idNumber.includes(e.trim());case"phone":return a.phone.includes(e.trim());case"email":return a.email?.toLowerCase().includes(s)||!1;default:return a.fullName.toLowerCase().includes(s)}})),(0,u.T)(i=>({patients:i,totalCount:i.length,hasMore:!1})),(0,d.c)(500),(0,h.M)(i=>console.log(`Search for "${e}" (${t}) returned ${i.totalCount} results`)))}getPatientById(e){const t=this.mockPatients.find(i=>i.id===e);return(0,l.of)(t||null).pipe((0,d.c)(200))}selectPatient(e){return new C.c(t=>{try{const i=this.validatePatientData(e);if(!i.isValid)return void t.error(new Error(`Invalid patient data: ${i.errors.join(", ")}`));const a=this.formatPatientData(e);this.selectedPatientSubject.next(a),t.next(a),t.complete(),console.log(`Patient selected: ${a.fullName} (ID: ${a.id})`)}catch(i){t.error(i)}}).pipe((0,d.c)(100))}getSelectedPatient(){return this.selectedPatientSubject.value}clearSelection(){this.selectedPatientSubject.next(null)}addPatient(e){const t={id:(this.mockPatients.length+1).toString(),fullName:`${e.firstName} ${e.firstLastName}`,firstName:e.firstName||"",firstLastName:e.firstLastName||"",secondLastName:e.secondLastName,idType:e.idType||"CC",idNumber:e.idNumber||"",birthDate:e.birthDate||"",age:e.age||0,gender:e.gender||"M",bloodType:e.bloodType,phone:e.phone||"",email:e.email,address:e.address,city:e.city,country:e.country||"Colombia",allergies:e.allergies||[],chronicConditions:e.chronicConditions||[],currentMedications:e.currentMedications||[],registrationDate:(new Date).toISOString().split("T")[0],status:"active",lastVisit:(new Date).toISOString().split("T")[0]};return this.mockPatients.push(t),(0,l.of)(t).pipe((0,d.c)(800))}updatePatient(e,t){const i=this.mockPatients.findIndex(a=>a.id===e);return-1===i?(0,l.of)(null):(this.mockPatients[i]={...this.mockPatients[i],...t},(0,l.of)(this.mockPatients[i]).pipe((0,d.c)(600)))}getAllPatients(){return(0,l.of)([...this.mockPatients]).pipe((0,d.c)(400))}validatePatientData(e){const t=[];return(!e.id||""===e.id.trim())&&t.push("Patient ID is required"),(!e.fullName||""===e.fullName.trim())&&t.push("Patient full name is required"),(!e.firstName||""===e.firstName.trim())&&t.push("Patient first name is required"),(!e.firstLastName||""===e.firstLastName.trim())&&t.push("Patient last name is required"),(!e.idNumber||""===e.idNumber.trim())&&t.push("Patient ID number is required"),(!e.birthDate||""===e.birthDate.trim())&&t.push("Patient birth date is required"),(!e.gender||"M"!==e.gender&&"F"!==e.gender)&&t.push("Valid patient gender is required"),"active"!==e.status&&"inactive"!==e.status&&t.push("Valid patient status is required"),"inactive"===e.status&&t.push("Cannot select inactive patient"),(e.age<0||e.age>150)&&t.push("Patient age must be between 0 and 150"),Array.isArray(e.allergies)||t.push("Patient allergies must be an array"),Array.isArray(e.chronicConditions)||t.push("Patient chronic conditions must be an array"),Array.isArray(e.currentMedications)||t.push("Patient current medications must be an array"),{isValid:0===t.length,errors:t}}formatPatientData(e){return{...e,fullName:e.fullName.trim(),firstName:e.firstName.trim(),firstLastName:e.firstLastName.trim(),secondLastName:e.secondLastName?.trim(),idNumber:e.idNumber.trim(),phone:e.phone.trim(),email:e.email?.trim().toLowerCase(),address:e.address?.trim(),city:e.city?.trim(),country:e.country.trim(),allergies:e.allergies.map(t=>t.trim()).filter(t=>t.length>0),chronicConditions:e.chronicConditions.map(t=>t.trim()).filter(t=>t.length>0),currentMedications:e.currentMedications.map(t=>t.trim()).filter(t=>t.length>0)}}selectPatientFromRecentList(e){return this.getPatientById(e).pipe((0,g.n)(t=>{if(!t)throw new Error(`Patient with ID ${e} not found`);return this.selectPatient(t)}))}selectPatientFromSearch(e){return this.selectPatient(e)}quickSelectPatient(e){const t=this.validatePatientData(e);if(!t.isValid)return void console.error("Cannot select patient:",t.errors);const i=this.formatPatientData(e);this.selectedPatientSubject.next(i),console.log(`Quick selected patient: ${i.fullName}`)}canSelectPatient(e){return this.validatePatientData(e).isValid}getPatientSelectionErrors(e){return this.validatePatientData(e).errors}calculatePatientStatistics(e){return(0,l.of)(this.patientPrescriptions[e]||[]).pipe((0,u.T)(t=>{const i=t.map(r=>this.mockPrescriptions.find(o=>o.id===r)).filter(r=>void 0!==r);return{totalPrescriptions:i.length,activePrescriptions:i.filter(r=>"pending"===r.status||"dispensed"===r.status).length}}),(0,d.c)(200),(0,h.M)(t=>console.log(`Patient ${e} statistics:`,t)))}getPatientPrescriptionHistory(e,t){return(0,l.of)(this.patientPrescriptions[e]||[]).pipe((0,u.T)(i=>{let a=i.map(c=>this.mockPrescriptions.find(M=>M.id===c)).filter(c=>void 0!==c);t&&(a=this.applyPrescriptionFilters(a,t));const s=a.length,r=a.filter(c=>"dispensed"===c.status).length,o=a.filter(c=>"pending"===c.status).length,m=a.filter(c=>"expired"===c.status).length,P=a.filter(c=>"cancelled"===c.status).length,D=s>0?Math.round(s/12*10)/10:0;return a.sort((c,M)=>new Date(M.date).getTime()-new Date(c.date).getTime()),{prescriptions:a,totalCount:s,statistics:{totalPrescriptions:s,dispensedCount:r,pendingCount:o,expiredCount:m,cancelledCount:P,averagePerMonth:D},filters:t||{}}}),(0,d.c)(300),(0,h.M)(i=>console.log(`Loaded prescription history for patient ${e}:`,i.totalCount,"prescriptions")))}filterPrescriptionsByStatusAndDate(e,t,i,a){const s={};return t&&t.length>0&&(s.status=t),(i||a)&&(s.dateRange={startDate:i||"1900-01-01",endDate:a||"2099-12-31"}),this.getPatientPrescriptionHistory(e,s).pipe((0,u.T)(r=>r.prescriptions),(0,h.M)(r=>console.log(`Filtered prescriptions for patient ${e}:`,r.length,"results")))}getEnhancedPatientData(e){const t=this.mockPatients.find(i=>i.id===e);return t?this.calculatePatientStatistics(e).pipe((0,g.n)(i=>this.getPatientPrescriptionHistory(e).pipe((0,u.T)(a=>({...t,statistics:{totalPrescriptions:i.totalPrescriptions,activePrescriptions:i.activePrescriptions,lastVisitDays:this.calculateDaysSinceLastVisit(t.lastVisit||""),averageVisitsPerMonth:2.5},medicalAlerts:{allergies:t.allergies.map(r=>({name:r,severity:"high",dateAdded:t.registrationDate})),chronicConditions:t.chronicConditions.map(r=>({name:r,severity:"medium",dateAdded:t.registrationDate})),criticalNotes:[]},contactInfo:{primaryPhone:t.phone,email:t.email,emergencyContact:t.emergencyContact},insurance:{provider:t.insuranceProvider||"No especificado",number:t.insuranceNumber||"",type:t.insuranceType||"B\xe1sico"},totalPrescriptions:i.totalPrescriptions,activePrescriptions:i.activePrescriptions,recentPrescriptions:a.prescriptions.slice(0,5),prescriptionHistory:a})))),(0,d.c)(400),(0,h.M)(i=>console.log(`Enhanced patient data loaded for ${i?.fullName}`))):(0,l.of)(null)}applyPrescriptionFilters(e,t){let i=[...e];if(t.status&&t.status.length>0&&(i=i.filter(a=>t.status.includes(a.status))),t.dateRange){const a=new Date(t.dateRange.startDate),s=new Date(t.dateRange.endDate);i=i.filter(r=>{const o=new Date(r.date);return o>=a&&o<=s})}if(t.doctors&&t.doctors.length>0&&(i=i.filter(a=>t.doctors.some(s=>a.doctor.name.toLowerCase().includes(s.toLowerCase())))),t.medications&&t.medications.length>0&&(i=i.filter(a=>a.medications.some(s=>t.medications.some(r=>s.name.toLowerCase().includes(r.toLowerCase()))))),t.searchTerm&&t.searchTerm.trim()){const a=t.searchTerm.toLowerCase().trim();i=i.filter(s=>s.diagnosis.toLowerCase().includes(a)||s.notes&&s.notes.toLowerCase().includes(a)||s.medications.some(r=>r.name.toLowerCase().includes(a))||s.doctor.name.toLowerCase().includes(a))}return i}calculateDaysSinceLastVisit(e){if(!e)return 0;const t=new Date(e),a=Math.abs((new Date).getTime()-t.getTime());return Math.ceil(a/864e5)}static{this.\u0275fac=function(t){return new(t||y)}}static{this.\u0275prov=v.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}}return y})()},204:(L,N,n)=>{n.d(N,{c:()=>s});var p=n(8839),l=n(8793),C=n(6697),u=n(9974),d=n(4360),h=n(5343),v=n(3703),b=n(1397),y=n(8750);function f(r,o){return o?m=>(0,l.x)(o.pipe((0,C.s)(1),function g(){return(0,u.N)((r,o)=>{r.subscribe((0,d._)(o,h.l))})}()),m.pipe(f(r))):(0,b.Z)((m,P)=>(0,y.Tg)(r(m,P)).pipe((0,C.s)(1),(0,v.u)(m)))}var e=n(1985),t=n(9470);function s(r,o=p.E){const m=function a(r=0,o,m=p.b){let P=-1;return null!=o&&((0,t.m)(o)?m=o:P=o),new e.c(D=>{let c=function i(r){return r instanceof Date&&!isNaN(r)}(r)?+r-m.now():r;c<0&&(c=0);let M=0;return m.schedule(function(){D.closed||(D.next(M++),0<=P?this.schedule(void 0,P):D.complete())},c)})}(r,o);return f(()=>m)}},8839:(L,N,n)=>{n.d(N,{b:()=>y,E:()=>b});var p=n(8359);class l extends p.yU{constructor(e,t){super()}schedule(e,t=0){return this}}const C={setInterval(f,e,...t){const{delegate:i}=C;return i?.setInterval?i.setInterval(f,e,...t):setInterval(f,e,...t)},clearInterval(f){const{delegate:e}=C;return(e?.clearInterval||clearInterval)(f)},delegate:void 0};var u=n(7908),h=n(6129);class g{constructor(e,t=g.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}g.now=h.U.now;const b=new class v extends g{constructor(e,t=g.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}(class d extends l{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const a=this.id,s=this.scheduler;return null!=a&&(this.id=this.recycleAsyncId(s,a,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return C.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&C.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let a,i=!1;try{this.work(e)}catch(s){i=!0,a=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),a}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,u.o)(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),y=b},6129:(L,N,n)=>{n.d(N,{U:()=>p});const p={now:()=>(p.delegate||Date).now(),delegate:void 0}}}]);