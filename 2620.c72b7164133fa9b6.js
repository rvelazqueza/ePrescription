"use strict";(self.webpackChunkeprescription_angular=self.webpackChunkeprescription_angular||[]).push([[2620],{2620:(E,m,s)=>{s.r(m),s.d(m,{ExportarFhirComponent:()=>c});var g=s(4523),F=s(177),d=s(4341),i=s(8516),u=s(8961),e=s(4438);function p(a,l){if(1&a&&(e.j41(0,"tr")(1,"td",52)(2,"div",53)(3,"p"),e.EFF(4),e.k0s(),e.j41(5,"p",54),e.EFF(6),e.k0s()()(),e.j41(7,"td",55),e.EFF(8),e.k0s(),e.j41(9,"td",56),e.EFF(10),e.k0s(),e.j41(11,"td",57),e.EFF(12),e.k0s(),e.j41(13,"td",52)(14,"span",58),e.EFF(15),e.k0s()(),e.j41(16,"td",56),e.EFF(17),e.k0s(),e.j41(18,"td",52)(19,"span"),e.EFF(20),e.k0s()(),e.j41(21,"td",52)(22,"span"),e.EFF(23),e.k0s()()()),2&a){const t=l.$implicit;e.R7$(4),e.JRh(t.exportDate),e.R7$(2),e.JRh(t.exportTime),e.R7$(2),e.JRh(t.prescriptionId),e.R7$(2),e.JRh(t.patientName),e.R7$(2),e.JRh(t.destination),e.R7$(3),e.SpI(" ",t.format," "),e.R7$(2),e.JRh(t.size),e.R7$(2),e.HbH("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+("completed"===t.status?"bg-green-100 text-green-700 border border-green-300":"bg-red-100 text-red-700 border border-red-300")),e.R7$(),e.SpI(" ","completed"===t.status?"Exitosa":"Fallida"," "),e.R7$(2),e.HbH("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+(t.responseCode.includes("200")?"bg-green-100 text-green-700 border border-green-300":"bg-red-100 text-red-700 border border-red-300")),e.R7$(),e.SpI(" ",t.responseCode," ")}}let c=(()=>{class a{constructor(){this.uploadIcon=i._OO,this.sendIcon=i.Vnp,this.checkIcon=i.Jly,this.xCircleIcon=i.Jpz,this.clockIcon=i.zD7,this.infoIcon=i.R2D,this.downloadIcon=i.f5X,this.selectedPrescription="",this.destination="",this.format="JSON",this.isExporting=!1,this.breadcrumbItems=[{label:"Interoperabilidad",route:"/interop"},{label:"Exportar Receta (FHIR)"}],this.exports=[{id:"EXP-001",prescriptionId:"RX-2024-0192",patientName:"Elena Mart\xednez",doctorName:"Dr. Carlos Mart\xednez",exportDate:"2024-10-01",exportTime:"08:35",resourceType:"MedicationRequest",version:"FHIR R4",format:"JSON",size:"12.4 KB",status:"completed",destination:"Sistema Nacional de Recetas",responseCode:"200 OK"},{id:"EXP-002",prescriptionId:"RX-2024-0195",patientName:"Roberto S\xe1nchez",doctorName:"Dra. Laura Ram\xedrez",exportDate:"2024-10-01",exportTime:"11:22",resourceType:"MedicationRequest",version:"FHIR R4",format:"JSON",size:"14.8 KB",status:"completed",destination:"Red de Farmacias Nacional",responseCode:"200 OK"},{id:"EXP-003",prescriptionId:"RX-2024-0178",patientName:"Carlos Ram\xedrez",doctorName:"Dr. Carlos Mart\xednez",exportDate:"2024-09-30",exportTime:"16:45",resourceType:"MedicationRequest",version:"FHIR R4",format:"JSON",size:"11.2 KB",status:"failed",destination:"Sistema Nacional de Recetas",responseCode:"500 Error"}]}get stats(){return{total:this.exports.length,completed:this.exports.filter(t=>"completed"===t.status).length,failed:this.exports.filter(t=>"failed"===t.status).length,today:this.exports.filter(t=>"2024-10-01"===t.exportDate).length}}get jsonPreview(){return'{\n  "resourceType": "MedicationRequest",\n  "id": "rx-2024-0198",\n  "meta": {\n    "versionId": "1",\n    "lastUpdated": "2024-10-01T14:35:00Z"\n  },\n  "status": "active",\n  "intent": "order",\n  "medicationCodeableConcept": {\n    "coding": [{\n      "system": "http://snomed.info/sct",\n      "code": "387517004",\n      "display": "Paracetamol 500mg"\n    }]\n  },\n  "subject": {\n    "reference": "Patient/pat-0012",\n    "display": "Mar\xeda Gonz\xe1lez"\n  },\n  "requester": {\n    "reference": "Practitioner/doc-001",\n    "display": "Dr. Carlos Mart\xednez"\n  },\n  "dosageInstruction": [{\n    "text": "1 tableta cada 8 horas",\n    "timing": {\n      "repeat": {\n        "frequency": 1,\n        "period": 8,\n        "periodUnit": "h"\n      }\n    }\n  }]\n}'}handleExport(){var t=this;return(0,g.A)(function*(){if(t.selectedPrescription&&t.destination){t.isExporting=!0;try{yield new Promise(r=>setTimeout(r,2e3));const o={id:`EXP-${String(t.exports.length+1).padStart(3,"0")}`,prescriptionId:t.selectedPrescription,patientName:t.getPrescriptionData(t.selectedPrescription).patient,doctorName:t.getPrescriptionData(t.selectedPrescription).doctor,exportDate:(new Date).toISOString().split("T")[0],exportTime:(new Date).toTimeString().slice(0,5),resourceType:"MedicationRequest",version:"FHIR R4",format:t.format,size:"12.4 KB",status:"completed",destination:t.getDestinationName(t.destination),responseCode:"200 OK"};t.exports=[o,...t.exports],t.selectedPrescription="",t.destination=""}catch(o){console.error("Error en exportaci\xf3n:",o)}finally{t.isExporting=!1}}})()}getPrescriptionData(t){const o={"RX-2024-0198":{patient:"Mar\xeda Gonz\xe1lez",doctor:"Dr. Carlos Mart\xednez"},"RX-2024-0199":{patient:"Carlos Ram\xedrez",doctor:"Dra. Laura Ram\xedrez"},"RX-2024-0200":{patient:"Ana Herrera",doctor:"Dr. Roberto S\xe1nchez"}};return o[t]||o["RX-2024-0198"]}getDestinationName(t){return{nacional:"Sistema Nacional de Recetas",farmacias:"Red de Farmacias Nacional",seguro:"Sistema de Aseguradoras",his:"HIS Hospital Regional"}[t]||t}static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-exportar-fhir"]],standalone:!0,features:[e.aNF],decls:128,vars:21,consts:[["title","Exportar Receta (FHIR)","description","Exportaci\xf3n de recetas en formato HL7 FHIR a sistemas externos","headerGradient","from-green-600 via-emerald-500 to-teal-600",3,"icon","breadcrumbItems"],[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"bg-white","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","cursor-pointer","border-l-4","border-l-green-500"],[1,"p-6"],[1,"flex","items-center","justify-between"],[1,"space-y-1","flex-1"],[1,"text-sm","text-gray-600"],[1,"text-3xl","font-bold","text-gray-900"],[1,"p-3","bg-green-100","rounded-xl"],[1,"w-8","h-8","text-green-600",3,"img"],[1,"bg-white","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","cursor-pointer","border-l-4","border-l-blue-500"],[1,"p-3","bg-blue-100","rounded-xl"],[1,"w-8","h-8","text-blue-600",3,"img"],[1,"bg-white","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","cursor-pointer","border-l-4","border-l-red-500"],[1,"p-3","bg-red-100","rounded-xl"],[1,"w-8","h-8","text-red-600",3,"img"],[1,"bg-white","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","cursor-pointer","border-l-4","border-l-purple-500"],[1,"p-3","bg-purple-100","rounded-xl"],[1,"w-8","h-8","text-purple-600",3,"img"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-white","rounded-lg","shadow"],[1,"p-6","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900"],[1,"p-6","space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["value",""],["value","RX-2024-0198"],["value","RX-2024-0199"],["value","RX-2024-0200"],["value","nacional"],["value","farmacias"],["value","seguro"],["value","his"],["value","JSON"],["value","XML"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-3"],[1,"flex","items-start","gap-2"],[1,"w-5","h-5","text-blue-600","flex-shrink-0","mt-0.5",3,"img"],[1,"text-sm","text-blue-900"],[1,"font-medium","mb-1"],[1,"text-blue-700"],[1,"w-full","flex","items-center","justify-center","gap-2","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed",3,"click","disabled"],[3,"img"],[1,"bg-gray-900","text-green-400","p-4","rounded-lg","font-mono","text-xs","overflow-auto","max-h-96"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase"],[1,"divide-y","divide-gray-200"],[4,"ngFor","ngForOf"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm"],[1,"text-gray-600"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-mono"],[1,"px-6","py-4","whitespace-nowrap","text-sm"],[1,"px-6","py-4","text-sm"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-green-100","text-green-700","border","border-green-300"]],template:function(o,r){1&o&&(e.j41(0,"app-page-layout",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"p",7),e.EFF(8,"Total exportaciones"),e.k0s(),e.j41(9,"p",8),e.EFF(10),e.k0s()(),e.j41(11,"div",9),e.nrm(12,"lucide-icon",10),e.k0s()()()(),e.j41(13,"div",11)(14,"div",4)(15,"div",5)(16,"div",6)(17,"p",7),e.EFF(18,"Exitosas"),e.k0s(),e.j41(19,"p",8),e.EFF(20),e.k0s()(),e.j41(21,"div",12),e.nrm(22,"lucide-icon",13),e.k0s()()()(),e.j41(23,"div",14)(24,"div",4)(25,"div",5)(26,"div",6)(27,"p",7),e.EFF(28,"Fallidas"),e.k0s(),e.j41(29,"p",8),e.EFF(30),e.k0s()(),e.j41(31,"div",15),e.nrm(32,"lucide-icon",16),e.k0s()()()(),e.j41(33,"div",17)(34,"div",4)(35,"div",5)(36,"div",6)(37,"p",7),e.EFF(38,"Hoy"),e.k0s(),e.j41(39,"p",8),e.EFF(40),e.k0s()(),e.j41(41,"div",18),e.nrm(42,"lucide-icon",19),e.k0s()()()()(),e.j41(43,"div",20)(44,"div",21)(45,"div",22)(46,"h2",23),e.EFF(47,"Nueva Exportaci\xf3n FHIR"),e.k0s()(),e.j41(48,"div",24)(49,"div")(50,"label",25),e.EFF(51,"Receta a exportar"),e.k0s(),e.j41(52,"select",26),e.mxI("ngModelChange",function(n){return e.DH7(r.selectedPrescription,n)||(r.selectedPrescription=n),n}),e.j41(53,"option",27),e.EFF(54,"Selecciona una receta..."),e.k0s(),e.j41(55,"option",28),e.EFF(56,"RX-2024-0198 - Mar\xeda Gonz\xe1lez"),e.k0s(),e.j41(57,"option",29),e.EFF(58,"RX-2024-0199 - Carlos Ram\xedrez"),e.k0s(),e.j41(59,"option",30),e.EFF(60,"RX-2024-0200 - Ana Herrera"),e.k0s()()(),e.j41(61,"div")(62,"label",25),e.EFF(63,"Sistema destino"),e.k0s(),e.j41(64,"select",26),e.mxI("ngModelChange",function(n){return e.DH7(r.destination,n)||(r.destination=n),n}),e.j41(65,"option",27),e.EFF(66,"Selecciona el destino..."),e.k0s(),e.j41(67,"option",31),e.EFF(68,"Sistema Nacional de Recetas"),e.k0s(),e.j41(69,"option",32),e.EFF(70,"Red de Farmacias Nacional"),e.k0s(),e.j41(71,"option",33),e.EFF(72,"Sistema de Aseguradoras"),e.k0s(),e.j41(73,"option",34),e.EFF(74,"HIS Hospital Regional"),e.k0s()()(),e.j41(75,"div")(76,"label",25),e.EFF(77,"Formato"),e.k0s(),e.j41(78,"select",26),e.mxI("ngModelChange",function(n){return e.DH7(r.format,n)||(r.format=n),n}),e.j41(79,"option",35),e.EFF(80,"JSON (recomendado)"),e.k0s(),e.j41(81,"option",36),e.EFF(82,"XML"),e.k0s()()(),e.j41(83,"div",37)(84,"div",38),e.nrm(85,"lucide-icon",39),e.j41(86,"div",40)(87,"p",41),e.EFF(88,"Exportaci\xf3n FHIR MedicationRequest"),e.k0s(),e.j41(89,"p",42),e.EFF(90,"Incluye: paciente, m\xe9dico, medicamentos, dosis, firma digital y c\xf3digo QR"),e.k0s()()()(),e.j41(91,"button",43),e.bIt("click",function(){return r.handleExport()}),e.nrm(92,"lucide-icon",44),e.EFF(93),e.k0s()()(),e.j41(94,"div",21)(95,"div",22)(96,"h2",23),e.EFF(97,"Preview JSON FHIR"),e.k0s()(),e.j41(98,"div",4)(99,"div",45)(100,"pre"),e.EFF(101),e.k0s()()()()(),e.j41(102,"div",21)(103,"div",22)(104,"h2",23),e.EFF(105,"Historial de Exportaciones"),e.k0s()(),e.j41(106,"div",46)(107,"table",47)(108,"thead",48)(109,"tr")(110,"th",49),e.EFF(111,"Fecha/Hora"),e.k0s(),e.j41(112,"th",49),e.EFF(113,"Receta"),e.k0s(),e.j41(114,"th",49),e.EFF(115,"Paciente"),e.k0s(),e.j41(116,"th",49),e.EFF(117,"Destino"),e.k0s(),e.j41(118,"th",49),e.EFF(119,"Formato"),e.k0s(),e.j41(120,"th",49),e.EFF(121,"Tama\xf1o"),e.k0s(),e.j41(122,"th",49),e.EFF(123,"Estado"),e.k0s(),e.j41(124,"th",49),e.EFF(125,"Respuesta"),e.k0s()()(),e.j41(126,"tbody",50),e.DNE(127,p,24,13,"tr",51),e.k0s()()()()()()),2&o&&(e.Y8G("icon",r.uploadIcon)("breadcrumbItems",r.breadcrumbItems),e.R7$(10),e.JRh(r.stats.total),e.R7$(2),e.Y8G("img",r.sendIcon),e.R7$(8),e.JRh(r.stats.completed),e.R7$(2),e.Y8G("img",r.checkIcon),e.R7$(8),e.JRh(r.stats.failed),e.R7$(2),e.Y8G("img",r.xCircleIcon),e.R7$(8),e.JRh(r.stats.today),e.R7$(2),e.Y8G("img",r.clockIcon),e.R7$(10),e.R50("ngModel",r.selectedPrescription),e.R7$(12),e.R50("ngModel",r.destination),e.R7$(14),e.R50("ngModel",r.format),e.R7$(7),e.Y8G("img",r.infoIcon),e.R7$(6),e.Y8G("disabled",r.isExporting||!r.selectedPrescription||!r.destination),e.R7$(),e.HbH("w-4 h-4 "+(r.isExporting?"animate-spin":"")),e.Y8G("img",r.uploadIcon),e.R7$(),e.SpI(" ",r.isExporting?"Exportando a FHIR...":"Exportar receta"," "),e.R7$(8),e.JRh(r.jsonPreview),e.R7$(26),e.Y8G("ngForOf",r.exports))},dependencies:[F.MD,F.Sq,d.YN,d.xH,d.y7,d.wz,d.BC,d.vS,i.flO,i.WGl,u.J],encapsulation:2})}}return a})()},4523:(E,m,s)=>{function g(d,i,u,e,p,c,a){try{var l=d[c](a),t=l.value}catch(o){return void u(o)}l.done?i(t):Promise.resolve(t).then(e,p)}function F(d){return function(){var i=this,u=arguments;return new Promise(function(e,p){var c=d.apply(i,u);function a(t){g(c,e,p,a,l,"next",t)}function l(t){g(c,e,p,a,l,"throw",t)}a(void 0)})}}s.d(m,{A:()=>F})}}]);